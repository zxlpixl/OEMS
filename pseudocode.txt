FUNCTION start()

    CALL FUNCTION clear()
    PRINT ('OEMS is loading...')
    sleeps for 3 seconds
    PRINT ('Done!')
    sleep for 1 second
    CALL FUNCTION main_menu()

ENDFUNCTION

FUNCTION clear()

    Using os module:
        Clear terminal screen

ENDFUNCTION


FUNCTION quit()
    CALL FUNCTION quit()
ENDFUNCTION


FUNCTION main_menu()
    CALL FUNCTION clear()
    sleeps for 0.75 seconds

    IF session status == 'guest' THEN

        menu = ''Welcome to OEMS, The Online Event Management System!
What would you like to do?

1. Log In
2. Register An Account
3. Event Information
4. Exit

Choice: '''

        PRINT (menu) 
        Get answer
        IF answer == 1 THEN
            CALL FUNCTION log_in()
        ELIF answer == 2 THEN
            CALL FUNCTION acc_register()
        ELIF answer == 3 THEN
            CALL FUNCTION list_event_menu()
        ELIF answer == 4 THEN
            CALL FUNCTION quit()
        ENDIF
    
    ELIF session_status == 'admin' THEN
        PRINT(f'Welcome to the OEMS admin menu, {acc_name}')

        menu ='''What would you like to do?

1. Add New Event
2. Modify Event 
3. Event Information 
4. Customer Records #function to be created
5. Exit

Choice: '''
        
        PRINT(menu)
        Get answer

        IF answer == 1 THEN
            CALL FUNCTION add_event()
        ELIF answer == 2 THEN
            CALL FUNCTION modify_event()
        ELIF answer == 3 THEN
            CALL FUNCTION list_event_menu()
        ELIF answer == 4 THEN
            CALL FUNCTION customer_record()
        ELIF answer == 5 THEN
            CALL FUNCTION quit()
        ENDIF
    
    ELIF session status == 'registered' THEN

        PRINT (f'Welcome back {acc_name}!')
        menu ='''What would you like to do?

1. Event Information 
2. View Cart #function to be created
3. Exit

Choice: '''
 
        PRINT(menu)
        Get answer
        IF answer == 1 THEN
            CALL FUNCTION list_event_menu()
        ELIF answer == 2 THEN
            CALL FUNCTION view_cart()
        ELIF answer == 3 THEN
            CALL FUCNTION quit()
        ENDIF
    
    ENDIF
ENDFUNCTION


FUNCTION log_in()
    CALL FUNCTION clear()
    sleeps for 0.75 seconds
    Declare session_status, acc_name as Global variable
    TF = True

    DOWHILE TF == True 
        OPEN account_info.txt in READ MODE with buffering set to 1
        READ line of files as info_file

        PRINT('OEMS Login')

        PRINT('Please enter your username: ')
        Get acc_name

        FOR line In info_file  STEP 1
            SPLIT line as acc_info with ',' as delimiter
            STRIP acc_info with index of 0 as acc_info_name
            STRIP acc_info with index of 1 as acc_info_password

            IF acc_name == acc_info_name THEN

                DOWHILE TF == True
                    PRINT('Please enter your password')
                    Get acc_password

                    IF acc_password == acc_info_password THEN
                        CALL FUNCTION clear()
                        sleeps for 0.75 seconds
                        PRINT(f'Logged in successfully. Welcome back {acc_name}.')

                        sleeps for 0.75 seconds
                        DOWHILE TF == True

                            PRINT('Are you an admin? [y/n] ') 
                            Get admin_confirmation

                            IF admin_confirmation == 'y' or admin_confirmation == 'Y' THEN
                                CALL FUNCTION clear()
                                sleeps for 0.75 seconds

                                DOWHILE TF == True

                                    PRINT('Please enter admin code (use this code for testing purposes:000) \nCode: ')
                                    Get admin_code

                                    IF admin_code == 000 THEN
                                        CALL FUNCTION clear()
                                        sleeps for 0.75 seconds
                                        PRINT('Thank you, redirecting you to the admin menu.....')
                                        CLOSE info_file
                                        session_status = 'admin'
                                        TF = False
                                        sleeps for 3 seconds
                                        CALL FUNCTION main_menu()

                                    ELSE
                                        CALL FUNCTION clear()
                                        sleeps for 0.75 seconds
                                        PRINT('Admin code does not exist, please try again.')
                                        CONTINUE
                                    
                                    ENDIF
                                
                                ENDWHILE
                            
                            ELIF admin_confirmation == 'n' or admin_confirmation == 'N' THEN 

                                CALL FUNCTION clear()
                                sleeps for 0.75 seconds
                                PRINT('Redirecting you to the menu...')
                                info_file.close
                                session_status = 'registered'
                                TF = False
                                CALL FUNCTION main_menu()
                            
                            ElSE 
                                PRINT("Answer not recognized, please try again.')
                                CONTINUE 
                            
                            ENDIF
                    
                    ELSE
                        CALL FUNCTION clear()
                        sleeps for 0.75 seconds
                        PRINT('OEMS Login')
                        PRINT('Your password is incorrect, please try again.')
                        CONTINUE
                    
                    ENDIF
                
                ENDWHILE
                
            ELSE 
                CONTINUE

            ENDIF
        
        ELSE
            CALL FUNCTION clear()
            sleeps for 0.75 seconds

            log_in_retry = '''The entered username does not exist.
What would you like to do?

1. Retry
2. Register new account
3. Main menu

Choice: ''' 

            PRINT(log_in_retry)
            Get log_in_retry
            IF log_in_retry == '1' THEN
                CALL FUNCTION clear()
                sleeps for 0.75 seconds
                CONTINUE
            
            ELIF log_in_retry == '2' THEN
                CLOSE info_file
                acc_name = None
                CALL FUNCTION acc_register()  

            ELIF log_in_retry =='3' THEN
                CALL FUNCTION main_menu()  
            ENDIF
        
        ENDFOR
    
    ENDWHILE

ENDFUNCTION


FUNCTION acc_register()

    CALL FUNCTION clear()
    sleeps for 0.75 seconds 

    DOWHILE True 
        status = True
        PRINT('OEMS Account Registration\n')  
        PRINT('Please enter your username: ')
        Get acc_name

        OPEN account_info.txt in READ mode 
        READ line of file as fhandler
        FOR line In fhandler STEP 1
            IF line STARTS WITH acc_name THEN 
                status = False
                break
            ENDIF
        ENDFOR
        
        IF status = False THEN
            CALL FUNCTION clear()
            PRINT("This username already exists, please use another username")
            sleeps for 3 seconds
            CALL FUNCTION clear()
            CONTINUE 
        ENDIF

        PRINT('Please enter your password: ')
        Get acc_password  
        PRINT('Please confirm your password: ')
        Get confirmation
        
        IF acc_password != confirmation THEN 
            CALL FUNCTION clear()
            sleeps for 0.75 seconds
            PRINT("Incorrect password please try again")
            CONTINUE
        
        ELIF acc_password = confirmation THEN
            CALL FUNCTION clear()
            sleeps for 0.75 seconds
            acc_info = [acc_name, acc_password]
            OPEN account_info.txt in APPEND mode with buffering set to 1
            APPEND acc_info into file as fhandler
            CLOSE fhandler
            PRINT('Your account has been successfully created.')
            3 seconds delay
            BREAK

        ENDIF

    ENDWHILE

    option = '''What would you like to do?
    1. Main Menu
    2. Log In
    3. Exit 
    Choice: '''

    CALL FUNCTION clear()
    sleeps for 0.75 seconds

    DOWHILE True 
        PRINT(option)
        Get choice
    
        IF choice == 1 THEN
            CALL FUNCTION main_menu()
        ELIF choice == 2 THEN
            CALL FUNCTION log_in()
        ELIF choice == 3 THEN   
            CALL FUNCTION quit()
        ELSE 
            PRINT("Invalid option please try again")
            continue 
        ENDIF

    ENDWHILE

ENDFUNCTION       
    


#2
FUNCTION category()

    CALL FUNCTION clear()
    sleeps for 0.75 seconds

    events = '''Events Categories Available:
    
    1. Sports
    2. E-Sports
    3. Technology
    4. Art
    5. General Entertainment
    6. Back to Main Menu

    Choice: '''

    DOWHILE True
        PRINT(events)
        Get answer
        
        IF answer <= 6 THEN
            ELIF answer == 6 THEN
                CALL FUNCTION main_menu()
            ELSE
                RETURN answer
            ENDIF

        ELSE
            CALL FUNCTION clear()
            sleeps for 0.75 seconds
            PRINT("Invalid option please try again.")
            CALL FUNCTION clear()
            sleeps for 0.75 seconds
            CONTINUE

        ENDIF

    ENDWHILE

ENDFUNCTION




#3 
FUNCTION add_event()

    choice = CALL FUNCTION category()

    IF choice == 1 THEN
        categoryid = 'Sports'
    ELIF choice == 2 THEN
        categoryid = 'E-Sports'
    ELIF choice == 3 THEN
        categoryid = 'Technology'
    ELIF choice == 4 THEN
        categoryid = 'Art'
    ELIF choice == 5 THEN
        categoryid = 'General Entertainment'
    ENDIF

    DOWHILE True
        status = True
        PRINT('Please enter the event name: ')
        Get event_name

        OPEN event.txt in READ mode 
        READ line of file as fhandler
        FOR line In fhandler STEP 1
            
            SPLIT line as event_info using "," as delimiter
            STRIP event_info with an index of 2 as name_availability

            IF name_availability == event_name THEN
                status  = False  
            ENDIF
        ENDFOR
        
        IF status == False:
            PRINT("Event exsits please try again")
            CONTINUE
        ENDIF

        CALL FUNCTION clear()
        sleeps for 0.75 seconds

        PRINT('How much is the event?(RM): ')
        Get event_price

        listid=1
        OPEN event.txt in READ mode 
        READ line of file as fhandler
        FOR line In fhandler STEP 1
            IF line ENDS WITH ("\n") THEN
                listid +=1
            ENDIF
        ENDFOR

        event_list = [listid, categoryid, event_name, event_price] 
        OPEN event.txt in APPEND mode with buffering set to 1
        APPEND event_list into file as fhandler
        CLOSE fhandler

        clear terminal
        sleeps for 0.75 seconds
        PRINT("Invalid option please try again.")
        CALL FUNCTION clear()
        sleeps for 0.75 seconds
        CONTINUE
    
    ENDWHILE

ENDFUNCTION


FUNCTION modify_event()
    CALL FUNCTION event_list()
    PRINT("Which event would you like to modify?[ID]: ")
    Get choice_id

    OPEN event.txt in READ mode with buffering set to 1
    READ line in file as fhandler_read

    FOR line IN fhandler_read STEP 1
        SPLIT line as event_info with ',' as delimiter
        STRIP event_info with index of 0 as event_id
        STRIP event_info with index of 1 as event_category
        STRIP event_info with index of 2 as event_name
        STRIP event_info with index of 3 as event_price

        option = '''Options available:
1. Change event category
2. Change event name
3. Change event price
4. Delete event 

Choice: '''
        
        IF event_id == choice_id THEN

            PRINT(option)
            Get option_input

            IF option_input == 1 THEN
                choice = CALL FUNCTION category()

                IF choice == 1 THEN
                    new_category = 'Sports'
                    BREAK
                ELIF choice == 2 THEN
                    new_category = 'E-Sports'
                    BREAK
                ELIF choice == 3 THEN
                    new_category = 'Technology'
                    BREAK
                ELIF choice == 4 THEN
                    new_category = 'Art'
                    BREAK
                ELIF choice == 5 THEN
                    new_category = 'General Entertainment'
                    BREAK
                ENDIF
            
            ELIF option_input == 2 THEN
                new_name = input('Please enter new event name: ')
                break
            
            ELIF option_input == 3 THEN
                new_price = (input('Please enter new price[RM]: '))
                break

            ENDIF
        
        ENDIF
    
    ENDFOR

    CLOSE fhandler_read

    WITH OPEN event.txt in READ mode as fhandler_read

        list_data_temp = []
        readlines in fhandler_read as list_data
        
        FOR line in list_data

            IF line STARTS WITH choice_id THEN
                
                IF option_input == 1 THEN
                        line = replace event_category with new_category in line
                ELIF option_input == 2 THEN
                        line = replace event_name with new_name in line
                ELIF option_input == 3 THEN
                        line = replace event_price with new_price in line
                ELIF option_input == 4 THEN
                        line = replace line with ""
                ENDIF

            ENDIF
            
            APPEND line into list_data_temp

        ENDFOR

    WITH OPEN event.text in WRITE mode as fhandler_write 

        FOR line in list_data_temp
            WRITE line in fhandler_write

        ENDFOR

    CALL FUNCTION clear()
    sleeps for 0.75 seconds
    PRINT("Modified complete, redirecting to main menu......")
    sleeps for 3 seconds
    CALL FUNCTION main_menu()


    RETURN

ENDFUNCITON


FUNCTION event_list()
    choice = CALL FUNCTION category()
    CALL FUNCTION clear()
    sleeps for 0.75 seconds

    OPEN event.txt in READ mode 
    READ line in file as event_file

    IF choice == 1 THEN
        categoryid = 'Sports'
    ELIF choice == 2 THEN
        categoryid = 'E-Sports'
    ELIF choice == 3 THEN
        categoryid = 'Technology'
    ELIF choice == 4 THEN
        categoryid = 'Art'
    ELIF choice == 5 THEN
        categoryid = 'General Entertainment'
    ENDIF

    PRINT('Category: ', categoryid, '\n')

    FOR line in event_file 
        SPLIT line as event_info with ',' as delimiter
        STRIP event_info with index of 0 as event_info_id
        STRIP event_info with index of 1 as event_info_category
        STRIP event_info with index of 2 as event_info_name
        STRIP event_info with index of 3 as event_info_price

        IF categoryid == event_info_category THEN
            PRINT(f'ID:{event_info_id}          Event:{event_info_name}          Price:RM{event_info_price}')
        ENDIF
    ENDFOR

ENDFUNCTION



FUNCTION list_event_menu()
    CALL FUNCTION event_list()

    DECLARE session_status as Global variable

    TF = True
    IF session status == 'guest' THEN
        event_menu = ''What would you like to do?

1.Back to category menu
2.Back to main menu

Choice: '''

        DOWHILE TF == True
            PRINT('\n')
            PRINT(event_menu)
            Get choice
            
            IF choice == '1' THEN
                TF = False
                CALL FUNCTION category()
            ELIF choice == '2' THEN
                TF = False
                CALL FUNCTION main_menu()
            ELSE
                CALL FUNCTION clear()
                PRINT('Invalid choice, please try again.')
                sleeps for 3 seconds
                CALL FUNCTION clear()
                CONTINUE
            ENDIF
        
        ENDWHILE

    ELIF session_status == 'registered' THEN
        event_menu = '''What would you like to do?

1.Add events to cart
2.Back to category menu
3.Back to main menu

Choice: '''

        DOWHILE TF == True 
            PRINT('\n')
            PRINT(event_menu)

            IF choice == '1' THEN
                TF = False
                CALL FUNCTION cart()
            ELIF choice == '2' THEN
                TF = False
                CALL FUNCTION category()
            ELIF choice == '3' THEN
                TF = False
                CALL FUNCTION main_menu()
            ELSE
                CALL FUNCTION clear()
                PRINT('Invalid choice, please try again.')
                sleeps for 3 seconds
                CALL FUNCTION clear()
                CONTINUE
            ENDIF
            
        ENDWHILE

    ENDIF

ENDFUNCTION  



                
      
            